
拷贝文件

```
import shutil
import os
import winsound


def copy(src_folder,dst_folder):

    if os.path.exists(dst_folder):
        try:
            shutil.rmtree(dst_folder)   
        except OSError as e:
            try:
                os.rmdir(dst_folder)
            except OSError as e:
                print('失败')
                return
    print("正在拷贝:"+dst_folder.split('\\')[1])
    shutil.copytree(src_folder, dst_folder)
    print("拷贝完成:"+dst_folder.split('\\')[1])


# 1
src_folder = 'C:\\Users\lgh\\3D Objects\\blog'
dst_folder = 'F:\\blog'
copy(src_folder,dst_folder)

# 2
src_folder = 'C:\\Users\\lgh\\3D Objects\\lib_file'
dst_folder = 'F:\\lib_file'
copy(src_folder,dst_folder)

# 3
src_folder = 'C:\\Users\\lgh\\3D Objects\\图片'
dst_folder = 'F:\\图片'
copy(src_folder,dst_folder)

# 4
src_folder = 'C:\\laragon\\www\\photobed'
dst_folder = 'F:\\photobed'
copy(src_folder,dst_folder)




winsound.Beep(1000, 4000)  # 参数分别为频率和时长，这里表示1000Hz的频率响铃1秒
```


## 类似图床的功能

	@echo off
	python L:/save_and_get_outer_link.py | clip
	

```

import win32ui
from PIL import Image, ImageGrab
from datetime import datetime
import os

im = ImageGrab.grabclipboard()
if isinstance(im, Image.Image):
    img = im
else:
    dlg = win32ui.CreateFileDialog(1)  # 1表示打开文件对话框
    dlg.SetOFNInitialDir(r'C:/Users/lgh/Desktop')  # 设置打开文件对话框中的初始显示目录
    dlg.DoModal()
    filename = dlg.GetPathName()  # 获取选择的文件名称
    img = Image.open(filename)

# 删除缩略图和质量参数
# img.thumbnail((778, 439), Image.ANTIALIAS)
# img = img.convert("RGB")

current_time = datetime.now()
time_string = current_time.strftime("%Y_%m_%d_%H_%M_%S")

# 保存文件
output_filename = "L:/photobed/" + time_string + ".png"
img.save(output_filename)

# 提取文件名的部分
filename_only = os.path.basename(output_filename)

# 打印文件名
print("http://114.116.43.154:80/photobed/"+filename_only,end="")


```


## 获取uuid

```
import random
random_num = int(random.random()*(10000000000000000))
print(random_num)

```


## 图片转base64


```
import win32ui, os, base64
from PIL import Image, ImageGrab
from datetime import datetime

im = ImageGrab.grabclipboard()
if isinstance(im, Image.Image):
    img = im
else:
    dlg = win32ui.CreateFileDialog(1)  # 1表示打开文件对话框
    dlg.SetOFNInitialDir(r'C:/Users/lgh/Desktop')  # 设置打开文件对话框中的初始显示目录
    dlg.DoModal()
    filename = dlg.GetPathName()  # 获取选择的文件名称
    img = Image.open(filename)

img.thumbnail((778, 439), Image.ANTIALIAS)
img = img.convert("RGB")


current_time = datetime.now()
time_string = current_time.strftime("%Y_%m_%d_%H_%M_%S")
print(time_string)


img.save("C:/Users/lgh/Desktop/"+time_string+".png",quality=70)
with open("C:/Users/lgh/Desktop/base64.png","rb") as f:
    base64_data = base64.b64encode(f.read())
    s = base64_data.decode()
    print("![img][tmp]\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[tmp]:data:image/png;base64,%s" % s)

# os.remove("C:/Users/lgh/Desktop/base64.png")

```


修改版本

```
import win32ui, os, base64
from PIL import Image, ImageGrab

im = ImageGrab.grabclipboard()
if isinstance(im, Image.Image):
    img = im
else:
    dlg = win32ui.CreateFileDialog(1)  # 1表示打开文件对话框
    dlg.SetOFNInitialDir(r'C:/Users/lgh/Desktop')  # 设置打开文件对话框中的初始显示目录
    dlg.DoModal()
    filename = dlg.GetPathName()  # 获取选择的文件名称
    img = Image.open(filename)

img.thumbnail((778, 439), Image.ANTIALIAS)
img = img.convert("RGB")
img.save("C:/Users/lgh/Desktop/base64.png",quality=70)
with open("C:/Users/lgh/Desktop/base64.png","rb") as f:
    base64_data = base64.b64encode(f.read())
    s = base64_data.decode()
    print("![img][tmp]\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[tmp]:data:image/png;base64,%s" % s)

# os.remove("C:/Users/lgh/Desktop/base64.png")

```






























